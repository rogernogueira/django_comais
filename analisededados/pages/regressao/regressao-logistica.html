<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regressão Logística - Análise de Regressão</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'bg-base': '#0f172a',
                        'bg-elevated': '#020617',
                        'bg-surface': '#1e293b',
                        'bg-muted': '#334155',
                        'text-primary': '#f1f5f9',
                        'text-secondary': '#cbd5e1',
                        'text-muted': '#94a3b8',
                        'reg-purple': '#8b5cf6',
                        'primary': '#8b5cf6',
                    }
                }
            }
        }
    </script>
    <style>
        .back-button {
            transition: all 0.2s ease;
        }

        .back-button:hover {
            background-color: rgba(139, 92, 246, 0.2);
            transform: translateX(-2px);
        }

        .element-clickable {
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .element-clickable:hover {
            background-color: rgba(139, 92, 246, 0.1);
            transform: translateY(-2px);
        }
    </style>
</head>

<body class="bg-bg-base text-text-primary font-sans p-8">
    <div class="max-w-6xl mx-auto">
        <div class="flex items-center mb-8">
            <button class="back-button bg-primary/20 p-3 rounded-lg mr-4"
                onclick="window.location.href='../../regressao.html'">
                <span class="text-primary text-lg">←</span>
            </button>
            <h1 class="text-4xl text-primary font-bold">Regressão Logística</h1>
        </div>

        <p class="text-xl text-center mb-12 text-text-secondary">Prevendo probabilidades e classificando categorias
            (Sim/Não, 0/1).</p>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Conceito e Curva Sigmoide -->
            <div class="space-y-6">
                <div class="bg-bg-muted/20 p-4 rounded-lg">
                    <h3 class="text-xl mb-4 text-primary font-bold">O que é?</h3>
                    <p class="text-text-secondary mb-4">
                        A Regressão Logística é usada quando a variável dependente (Y) é <strong>categórica
                            binária</strong> (0 ou 1, Sim ou Não).
                        Ao invés de prever valores contínuos, prevê <strong>probabilidades</strong>.
                    </p>
                    <div class="bg-primary/10 p-4 rounded border border-primary/30 text-center mb-4">
                        <p class="text-lg text-primary font-mono font-bold mb-2">
                            P(Y=1) = 1 / (1 + e^(-z))
                        </p>
                        <p class="text-sm text-text-muted mb-2">onde z = β₀ + β₁X₁ + β₂X₂ + ...</p>
                        <div class="text-xs text-text-muted">
                            <p>Função Sigmoide (ou Logística)</p>
                        </div>
                    </div>
                </div>

                <div class="bg-bg-muted/20 p-4 rounded-lg">
                    <h3 class="text-xl mb-4 text-primary font-bold">Por que não usar Regressão Linear?</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex items-start p-2 bg-red-500/10 rounded">
                            <span class="text-red-400 mr-2">✗</span>
                            <span class="text-text-secondary">Pode prever valores fora de [0,1]</span>
                        </div>
                        <div class="flex items-start p-2 bg-red-500/10 rounded">
                            <span class="text-red-400 mr-2">✗</span>
                            <span class="text-text-secondary">Viola pressupostos (resíduos não normais)</span>
                        </div>
                        <div class="flex items-start p-2 bg-green-500/10 rounded">
                            <span class="text-green-400 mr-2">✓</span>
                            <span class="text-text-secondary">Sigmoide sempre retorna [0,1] = probabilidade
                                válida</span>
                        </div>
                    </div>
                </div>

                <div class="bg-bg-muted/20 p-4 rounded-lg">
                    <h3 class="text-xl mb-4 text-primary font-bold">Exemplos de Uso</h3>
                    <div class="space-y-2 text-sm">
                        <div class="bg-bg-surface p-2 rounded">
                            <p class="text-white font-bold">Email é Spam?</p>
                            <p class="text-xs text-text-muted">Y = 1 (Spam), Y = 0 (Normal)</p>
                        </div>
                        <div class="bg-bg-surface p-2 rounded">
                            <p class="text-white font-bold">Cliente vai comprar?</p>
                            <p class="text-xs text-text-muted">Y = 1 (Sim), Y = 0 (Não)</p>
                        </div>
                        <div class="bg-bg-surface p-2 rounded">
                            <p class="text-white font-bold">Paciente tem doença?</p>
                            <p class="text-xs text-text-muted">Y = 1 (Positivo), Y = 0 (Negativo)</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Visualização Interativa -->
            <div class="space-y-6">
                <div class="bg-bg-muted/20 p-4 rounded-lg">
                    <h3 class="text-xl mb-4 text-primary font-bold">Curva Sigmoide Interativa</h3>
                    <div class="bg-black/30 rounded-lg p-4">
                        <canvas id="sigmoidCanvas" class="w-full h-48 mb-4"></canvas>

                        <div class="space-y-4">
                            <div>
                                <label class="text-xs text-text-muted flex justify-between mb-1">
                                    <span>Inclinação (β₁) - "Velocidade da decisão"</span>
                                    <span id="beta1Val" class="font-mono text-primary font-bold">1.0</span>
                                </label>
                                <input type="range" id="beta1" min="0.1" max="5" step="0.1" value="1"
                                    class="w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-reg-purple">
                            </div>
                            <div>
                                <label class="text-xs text-text-muted flex justify-between mb-1">
                                    <span>Intercepto (β₀) - "Ponto de virada"</span>
                                    <span id="beta0Val" class="font-mono text-primary font-bold">0.0</span>
                                </label>
                                <input type="range" id="beta0" min="-5" max="5" step="0.1" value="0"
                                    class="w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-reg-purple">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-bg-muted/20 p-4 rounded-lg">
                    <h3 class="text-xl mb-4 text-primary font-bold">Threshold (Limiar de Decisão)</h3>
                    <p class="text-text-secondary text-sm mb-3">
                        Convertemos probabilidade em classificação usando um threshold (geralmente 0.5):
                    </p>
                    <div class="bg-bg-surface p-3 rounded">
                        <p class="text-sm text-white mb-2">Se P(Y=1) ≥ 0.5 → Classificar como 1</p>
                        <p class="text-sm text-white">Se P(Y=1) < 0.5 → Classificar como 0</p>
                    </div>
                    <p class="text-xs text-text-muted mt-2">
                        Você pode ajustar o threshold dependendo do custo de erros (FP vs FN).
                    </p>
                </div>
            </div>
        </div>

        <!-- Odds e Odds Ratio -->
        <div class="mt-8 pt-6 border-t border-bg-muted">
            <h3 class="text-2xl mb-6 text-primary font-bold text-center">Odds e Odds Ratio</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-bg-surface p-6 rounded-lg border border-gray-700">
                    <h4 class="text-lg font-bold text-white mb-3">Odds (Razão de Chances)</h4>
                    <div class="bg-primary/10 p-3 rounded text-center mb-3">
                        <p class="text-lg text-primary font-mono">Odds = P / (1 - P)</p>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">
                        Se P = 0.8, então Odds = 0.8 / 0.2 = 4
                    </p>
                    <div class="bg-black/30 p-3 rounded">
                        <div class="flex items-center space-x-4">
                            <div class="flex-1">
                                <label class="text-xs text-text-muted block mb-1">Probabilidade (P)</label>
                                <input type="number" id="probInput" value="0.8" step="0.1" max="0.99" min="0.01"
                                    class="w-full bg-gray-800 border border-gray-600 rounded px-2 py-1 text-white">
                            </div>
                            <div class="text-2xl text-text-muted">→</div>
                            <div class="flex-1">
                                <label class="text-xs text-text-muted block mb-1">Odds</label>
                                <div id="oddsOutput" class="text-xl font-bold text-primary">4.00</div>
                            </div>
                        </div>
                        <p class="text-xs text-text-muted mt-2">"4 para 1" de chance de acontecer.</p>
                    </div>
                </div>

                <div class="bg-bg-surface p-6 rounded-lg border border-gray-700">
                    <h4 class="text-lg font-bold text-white mb-3">Odds Ratio (OR)</h4>
                    <p class="text-sm text-text-secondary mb-3">
                        Mede o quanto as chances mudam quando X aumenta 1 unidade.
                    </p>
                    <div class="bg-primary/10 p-3 rounded text-center mb-3">
                        <p class="text-lg text-primary font-mono">OR = e^β₁</p>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="bg-green-500/10 p-2 rounded">
                            <p class="text-green-400 font-bold">OR = 2</p>
                            <p class="text-xs text-text-muted">Chances dobram para cada +1 em X</p>
                        </div>
                        <div class="bg-gray-500/10 p-2 rounded">
                            <p class="text-gray-400 font-bold">OR = 1</p>
                            <p class="text-xs text-text-muted">X não afeta as chances</p>
                        </div>
                        <div class="bg-red-500/10 p-2 rounded">
                            <p class="text-red-400 font-bold">OR = 0.5</p>
                            <p class="text-xs text-text-muted">Chances caem pela metade</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Matriz de Confusão -->
        <div class="mt-8 pt-6 border-t border-bg-muted">
            <h3 class="text-2xl mb-6 text-primary font-bold text-center">Avaliação: Matriz de Confusão</h3>
            <div class="max-w-2xl mx-auto mb-6">
                <div class="grid grid-cols-3 gap-2 text-center">
                    <div></div>
                    <div class="text-sm text-text-muted font-bold">Predito: 1</div>
                    <div class="text-sm text-text-muted font-bold">Predito: 0</div>

                    <div class="text-sm text-text-muted font-bold flex items-center">Real: 1</div>
                    <div class="bg-green-500/20 border-2 border-green-500 p-4 rounded-lg">
                        <p class="text-xl font-bold text-green-400">VP</p>
                        <p class="text-xs text-green-300">Verdadeiro Positivo</p>
                    </div>
                    <div class="bg-red-500/20 border-2 border-red-500 p-4 rounded-lg">
                        <p class="text-xl font-bold text-red-400">FN</p>
                        <p class="text-xs text-red-300">Falso Negativo</p>
                    </div>

                    <div class="text-sm text-text-muted font-bold flex items-center">Real: 0</div>
                    <div class="bg-red-500/20 border-2 border-red-500 p-4 rounded-lg">
                        <p class="text-xl font-bold text-red-400">FP</p>
                        <p class="text-xs text-red-300">Falso Positivo</p>
                    </div>
                    <div class="bg-green-500/20 border-2 border-green-500 p-4 rounded-lg">
                        <p class="text-xl font-bold text-green-400">VN</p>
                        <p class="text-xs text-green-300">Verdadeiro Negativo</p>
                    </div>
                </div>
            </div>
            <p class="text-center text-text-secondary mb-4">
                A partir da matriz, calculamos Acurácia, Precisão, Recall, F1-Score e AUC.
            </p>
        </div>

        <!-- Links -->
        <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-purple-900/20 p-6 rounded-2xl border border-purple-500/30 flex flex-col justify-between">
                <div>
                    <h3 class="text-xl font-bold text-purple-400">Métricas de Classificação</h3>
                    <p class="text-sm text-purple-200">Aprenda a avaliar modelos de classificação com Acurácia,
                        Precisão, Recall e AUC.</p>
                </div>
                <a href="metricas-classificacao.html"
                    class="mt-4 bg-purple-600 hover:bg-purple-500 text-white px-6 py-2 rounded-lg font-semibold transition-colors flex items-center justify-center">
                    Ver Métricas →
                </a>
            </div>

            <div class="bg-blue-900/20 p-6 rounded-2xl border border-blue-500/30 flex flex-col justify-between">
                <div>
                    <h3 class="text-xl font-bold text-blue-400">Regressão Linear</h3>
                    <p class="text-sm text-blue-200">Compare com Regressão Linear para variáveis contínuas.</p>
                </div>
                <a href="regressao-linear.html"
                    class="mt-4 bg-blue-600 hover:bg-blue-500 text-white px-6 py-2 rounded-lg font-semibold transition-colors flex items-center justify-center">
                    Ver Regressão Linear →
                </a>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('sigmoidCanvas');
        const ctx = canvas.getContext('2d');
        const beta1Input = document.getElementById('beta1');
        const beta0Input = document.getElementById('beta0');
        const beta1Val = document.getElementById('beta1Val');
        const beta0Val = document.getElementById('beta0Val');

        function sigmoid(x, beta0, beta1) {
            const z = beta0 + beta1 * x;
            return 1 / (1 + Math.exp(-z));
        }

        function drawSigmoid() {
            const width = canvas.width;
            const height = canvas.height;
            const beta0 = parseFloat(beta0Input.value);
            const beta1 = parseFloat(beta1Input.value);

            beta0Val.textContent = beta0.toFixed(1);
            beta1Val.textContent = beta1.toFixed(1);

            ctx.clearRect(0, 0, width, height);

            // Grid
            ctx.strokeStyle = '#334155';
            ctx.lineWidth = 0.5;
            ctx.beginPath();
            for (let i = 0; i < width; i += 40) { ctx.moveTo(i, 0); ctx.lineTo(i, height); }
            for (let i = 0; i < height; i += 40) { ctx.moveTo(0, i); ctx.lineTo(width, i); }
            ctx.stroke();

            // Axes
            ctx.strokeStyle = '#64748b';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(0, height / 2); ctx.lineTo(width, height / 2); // P = 0.5
            ctx.stroke();

            // Labels
            ctx.fillStyle = '#94a3b8';
            ctx.font = '10px sans-serif';
            ctx.fillText('P = 1', 5, 15);
            ctx.fillText('P = 0.5', 5, height / 2 - 5);
            ctx.fillText('P = 0', 5, height - 5);

            // Sigmoid curve
            ctx.strokeStyle = '#8b5cf6';
            ctx.lineWidth = 3;
            ctx.beginPath();

            for (let px = 0; px <= width; px++) {
                const x = (px / width) * 20 - 10; // Map to [-10, 10]
                const p = sigmoid(x, beta0, beta1);
                const py = height - (p * height);

                if (px === 0) ctx.moveTo(px, py);
                else ctx.lineTo(px, py);
            }
            ctx.stroke();

            // Threshold line at 0.5
            ctx.strokeStyle = '#ef4444';
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(0, height / 2);
            ctx.lineTo(width, height / 2);
            ctx.stroke();
            ctx.setLineDash([]);
        }

        function setupCanvas() {
            const rect = canvas.getBoundingClientRect();
            const dpr = window.devicePixelRatio || 1;
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            ctx.scale(dpr, dpr);
            drawSigmoid();
        }

        beta1Input.addEventListener('input', drawSigmoid);
        beta0Input.addEventListener('input', drawSigmoid);
        window.addEventListener('resize', setupCanvas);
        setTimeout(setupCanvas, 50);

        // Odds calculator
        const probInput = document.getElementById('probInput');
        const oddsOutput = document.getElementById('oddsOutput');

        function updateOdds() {
            const p = parseFloat(probInput.value);
            if (p >= 0 && p < 1) {
                const odds = p / (1 - p);
                oddsOutput.textContent = odds.toFixed(2);
            }
        }

        probInput.addEventListener('input', updateOdds);
        updateOdds();
    </script>
</body>

</html>